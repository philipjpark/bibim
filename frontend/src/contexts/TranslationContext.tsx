import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';
import translationService from '../services/translationService';
import { Typography } from '@mui/material';

// Language codes
export type Language = 'en' | 'ko' | 'ja' | 'zh' | 'es' | 'fr' | 'de';

interface TranslationContextType {
  currentLanguage: Language;
  setLanguage: (lang: Language) => void;
  translate: (text: string, targetLang?: Language) => Promise<string>;
  translateSync: (text: string, targetLang?: Language) => string;
  isTranslating: boolean;
  translationCache: Map<string, string>;
  clearCache: () => void;
}

const TranslationContext = createContext<TranslationContextType | undefined>(undefined);

// Static translations for common UI elements (fallback)
const staticTranslations: Record<Language, Record<string, string>> = {
  en: {
    'Welcome to Bibim 🥘': 'Welcome to Bibim 🥘',
    'Your friendly AI-powered crypto trading companion. Mix your perfect strategy like bibimbap... more like cryptobap (크립토밥)!': 'Your friendly AI-powered crypto trading companion. Mix your perfect strategy like bibimbap... more like cryptobap (크립토밥)!',
    'Start Mixing Your Strategy': 'Start Mixing Your Strategy',
    "Chef Trader's Prep Station": "Chef Trader's Prep Station",
    'Why Choose Bibim?': 'Why Choose Bibim?',
    'AI-Powered Strategy Chef': 'AI-Powered Strategy Chef',
    'Our AI chef helps you create and optimize your trading strategies with precision.': 'Our AI chef helps you create and optimize your trading strategies with precision.',
    'Market Data Kitchen': 'Market Data Kitchen',
    'Access real-time market data and analytics to make informed decisions.': 'Access real-time market data and analytics to make informed decisions.',
    'Sentiment Analysis Spice': 'Sentiment Analysis Spice',
    'Add market sentiment analysis to your strategy for that extra flavor.': 'Add market sentiment analysis to your strategy for that extra flavor.',
    'Created by: philxdaegu': 'Created by: philxdaegu',
    'Dashboard': 'Dashboard',
    'Strategy Builder': 'Strategy Builder',
    'Backtest': 'Backtest',
    'Crypto Guide': 'Crypto Guide',
    'Strategy Builder 🥘': 'Strategy Builder 🥘',
    'Strategy Chef': 'Strategy Chef',
    'Hello! I\'m your AI Strategy Chef. How can I help you create your perfect trading strategy today? 🥘': 'Hello! I\'m your AI Strategy Chef. How can I help you create your perfect trading strategy today? 🥘',
    'I understand you want to create a strategy. Let me help you mix the perfect ingredients for your trading success! 🥢': 'I understand you want to create a strategy. Let me help you mix the perfect ingredients for your trading success! 🥢',
    'Tell me about your trading strategy...': 'Tell me about your trading strategy...',
    'Refresh Data': 'Refresh Data',
    'Updated': 'Updated',
    'Volume': 'Volume',
    'Sentiment Spice': 'Sentiment Spice',
    'Refresh Sentiment': 'Refresh Sentiment',
    'positive': 'positive',
    'neutral': 'neutral',
    'negative': 'negative',
    'Confidence': 'Confidence',
    'BBM Token Launch': 'BBM Token Launch',
    'Join the future of AI-powered crypto trading with Bibim\'s native token': 'Join the future of AI-powered crypto trading with Bibim\'s native token',
    'Governance Rights': 'Governance Rights',
    'BBM token holders can participate in platform governance and strategy voting.': 'BBM token holders can participate in platform governance and strategy voting.',
    'Strategy Access': 'Strategy Access',
    'Access to premium AI-powered trading strategies and backtesting tools.': 'Access to premium AI-powered trading strategies and backtesting tools.',
    'Revenue Sharing': 'Revenue Sharing',
    'Earn a share of platform fees and strategy performance rewards.': 'Earn a share of platform fees and strategy performance rewards.',
    'Token Sale Details': 'Token Sale Details',
    'Total Supply': 'Total Supply',
    'Initial Price': 'Initial Price',
    'Launch Date': 'Launch Date',
    'Join Waitlist': 'Join Waitlist',
    'Loading...': 'Loading...',
    'Error': 'Error',
    'Save': 'Save',
    'Cancel': 'Cancel',
    'Submit': 'Submit',
    'R&D-Agent-Quant Framework': 'R&D-Agent-Quant Framework',
    'Autonomous Research, Development, and Quantitative Trading Platform': 'Autonomous Research, Development, and Quantitative Trading Platform',
    'Research Progress': 'Research Progress',
    'Development Status': 'Development Status',
    'Agent Activity': 'Agent Activity',
    'Quant Performance': 'Quant Performance',
    'Research': 'Research',
    'Development': 'Development',
    'Agent Framework': 'Agent Framework',
    'Quant Strategies': 'Quant Strategies',
    'Research Corpus': 'Research Corpus',
    'Strategy Backtest': 'Strategy Backtest',
    'Backtest Configuration': 'Backtest Configuration',
    'Timeframe': 'Timeframe',
    '1 Minute': '1 Minute',
    '5 Minutes': '5 Minutes',
    '15 Minutes': '15 Minutes',
    '1 Hour': '1 Hour',
    '4 Hours': '4 Hours',
    '1 Day': '1 Day',
    'Start Date': 'Start Date',
    'End Date': 'End Date',
    'Running...': 'Running...',
    'Run Backtest': 'Run Backtest',
    'Backtest Results': 'Backtest Results',
    'Save Results': 'Save Results',
    'Share Results': 'Share Results',
    'Price Chart': 'Price Chart',
    'Candlestick': 'Candlestick',
    'Line': 'Line',
    'Total Return': 'Total Return',
    'Win Rate': 'Win Rate',
    'Performance Metrics': 'Performance Metrics',
    'Profit Factor': 'Profit Factor',
    'Sharpe Ratio': 'Sharpe Ratio',
    'Crypto Trading Glossary for Beginners': 'Crypto Trading Glossary for Beginners',
    'Learn crypto terms with traditional finance comparisons': 'Learn crypto terms with traditional finance comparisons',
    'Search crypto or traditional terms...': 'Search crypto or traditional terms...',
    'Side-by-Side Comparison': 'Side-by-Side Comparison',
    'Accordion View': 'Accordion View',
    'Examples:': 'Examples:',
    'Example:': 'Example:',
    'Learning Progress': 'Learning Progress',
    'Beginner Terms': 'Beginner Terms',
    'Intermediate Terms': 'Intermediate Terms',
    'Advanced Terms': 'Advanced Terms',
    'Total Showing': 'Total Showing',
    'Research Corpus Manager': 'Research Corpus Manager',
    'Organize your research materials, PDFs, URLs, and notes to build a comprehensive knowledge base for your trading strategies.': 'Organize your research materials, PDFs, URLs, and notes to build a comprehensive knowledge base for your trading strategies.',
    'Uploading...': 'Uploading...',
    'Upload PDF': 'Upload PDF',
    'Upload Image': 'Upload Image',
    'Add URL': 'Add URL',
    'Add Note': 'Add Note',
    'Search research items...': 'Search research items...',
    'Filter by Tags': 'Filter by Tags',
    'All Items': 'All Items',
    'PDFs': 'PDFs',
    'URLs': 'URLs',
    'Notes': 'Notes',
    'Images': 'Images',
    'No research items found. Start by uploading some PDFs or adding URLs!': 'No research items found. Start by uploading some PDFs or adding URLs!',
    'Added': 'Added',
    'Edit': 'Edit',
    'View': 'View',
    'Open Link': 'Open Link',
    'Delete': 'Delete',
    'Edit Item': 'Edit Item',
    'Title': 'Title',
    'URL': 'URL',
    'Content': 'Content',
    'Summary': 'Summary',
    'Tags': 'Tags',
    'Add Item': 'Add Item',
    'Portfolio Dashboard': 'Portfolio Dashboard',
    'Track your crypto holdings and performance': 'Track your crypto holdings and performance',
    'Total Portfolio Value': 'Total Portfolio Value',
    '24h Change': '24h Change',
    'Total P&L': 'Total P&L',
    'Assets': 'Assets',
    'Holdings': 'Holdings',
    'Your Holdings': 'Your Holdings',
    'Asset': 'Asset',
    'Amount': 'Amount',
    'Value': 'Value',
    'Allocation': 'Allocation',
    'Actions': 'Actions',
    'View Details': 'View Details',
    'Trade': 'Trade',
    'Refresh': 'Refresh',
    'All time': 'All time',
    'Strategy Overview': 'Strategy Overview',
    'Key Metrics': 'Key Metrics',
    'Implementation': 'Implementation',
    'Important Considerations': 'Important Considerations',
    'Generated Backtest Code': 'Generated Backtest Code',
    'Copy Strategy': 'Copy Strategy',
    'Generate Backtest Code': 'Generate Backtest Code',
    'View Analysis': 'View Analysis',
    'Quick Strategy Ideas': 'Quick Strategy Ideas',
    'Chat': 'Chat',
    'Analysis': 'Analysis',
    'Close': 'Close',
    'Download': 'Download',
    'Risk': 'Risk',
    'Low': 'Low',
    'Medium': 'Medium',
    'High': 'High',
    'Expected Return': 'Expected Return',
    'Cooking up your strategy': 'Cooking up your strategy',
  },
  ko: {
    'Welcome to Bibim 🥘': '비빔에 오신 것을 환영합니다 🥘',
    'Your friendly AI-powered crypto trading companion. Mix your perfect strategy like bibimbap... more like cryptobap (크립토밥)!': '친근한 AI 기반 암호화폐 거래 동반자입니다. 비빔밥처럼 완벽한 전략을 섞어보세요... 크립토밥처럼요!',
    'Start Mixing Your Strategy': '전략 믹싱 시작하기',
    "Chef Trader's Prep Station": '셰프 트레이더의 준비 스테이션',
    'Why Choose Bibim?': '왜 비빔을 선택해야 할까요?',
    'AI-Powered Strategy Chef': 'AI 기반 전략 셰프',
    'Our AI chef helps you create and optimize your trading strategies with precision.': '우리의 AI 셰프가 정밀하게 거래 전략을 생성하고 최적화하는 데 도움을 드립니다.',
    'Market Data Kitchen': '마켓 데이터 키친',
    'Access real-time market data and analytics to make informed decisions.': '실시간 시장 데이터와 분석에 접근하여 정보에 기반한 결정을 내리세요.',
    'Sentiment Analysis Spice': '감정 분석 양념',
    'Add market sentiment analysis to your strategy for that extra flavor.': '전략에 시장 감정 분석을 추가하여 특별한 맛을 더하세요.',
    'Created by: philxdaegu ': '제작자: 박상용',
    'Dashboard': '대시보드',
    'Strategy Builder': '전략 빌더',
    'Backtest': '백테스트',
    'Crypto Guide': '암호화폐 가이드',
    'Strategy Builder 🥘': '전략 빌더 🥘',
    'Strategy Chef': '전략 셰프',
    'Hello! I\'m your AI Strategy Chef. How can I help you create your perfect trading strategy today? 🥘': '안녕하세요! 저는 AI 전략 셰프입니다. 오늘 완벽한 거래 전략을 만드는 데 어떻게 도움을 드릴까요? 🥘',
    'I understand you want to create a strategy. Let me help you mix the perfect ingredients for your trading success! 🥢': '전략을 만들고 싶으시는군요. 거래 성공을 위한 완벽한 재료들을 섞는 데 도움을 드리겠습니다! 🥢',
    'Tell me about your trading strategy...': '거래 전략에 대해 말씀해 주세요...',
    'Refresh Data': '데이터 새로고침',
    'Updated': '업데이트됨',
    'Volume': '거래량',
    'Sentiment Spice': '감정 분석 양념',
    'Refresh Sentiment': '감정 분석 새로고침',
    'positive': '긍정적',
    'neutral': '중립적',
    'negative': '부정적',
    'Confidence': '신뢰도',
    'BBM Token Launch': 'BBM 토큰 런칭',
    'Join the future of AI-powered crypto trading with Bibim\'s native token': '비빔의 네이티브 토큰으로 AI 기반 암호화폐 거래의 미래에 참여하세요',
    'Governance Rights': '거버넌스 권한',
    'BBM token holders can participate in platform governance and strategy voting.': 'BBM 토큰 보유자는 플랫폼 거버넌스와 전략 투표에 참여할 수 있습니다.',
    'Strategy Access': '전략 접근',
    'Access to premium AI-powered trading strategies and backtesting tools.': '프리미엄 AI 기반 거래 전략과 백테스팅 도구에 접근하세요.',
    'Revenue Sharing': '수익 공유',
    'Earn a share of platform fees and strategy performance rewards.': '플랫폼 수수료와 전략 성과 보상의 일부를 획득하세요.',
    'Token Sale Details': '토큰 세일 상세정보',
    'Total Supply': '총 공급량',
    'Initial Price': '초기 가격',
    'Launch Date': '런칭 날짜',
    'Join Waitlist': '대기자 명단 참여',
    'Loading...': '로딩 중...',
    'Error': '오류',
    'Save': '저장',
    'Cancel': '취소',
    'Submit': '제출',
    'R&D-Agent-Quant Framework': 'R&D-Agent-Quant Framework',
    'Autonomous Research, Development, and Quantitative Trading Platform': 'Autonomous Research, Development, and Quantitative Trading Platform',
    'Research Progress': 'Research Progress',
    'Development Status': 'Development Status',
    'Agent Activity': 'Agent Activity',
    'Quant Performance': 'Quant Performance',
    'Research': 'Research',
    'Development': 'Development',
    'Agent Framework': 'Agent Framework',
    'Quant Strategies': 'Quant Strategies',
    'Research Corpus': '연구 코퍼스',
    'Strategy Backtest': 'Strategy Backtest',
    'Backtest Configuration': 'Backtest Configuration',
    'Timeframe': 'Timeframe',
    '1 Minute': '1 Minute',
    '5 Minutes': '5 Minutes',
    '15 Minutes': '15 Minutes',
    '1 Hour': '1 Hour',
    '4 Hours': '4 Hours',
    '1 Day': '1 Day',
    'Start Date': 'Start Date',
    'End Date': 'End Date',
    'Running...': 'Running...',
    'Run Backtest': 'Run Backtest',
    'Backtest Results': 'Backtest Results',
    'Save Results': 'Save Results',
    'Share Results': 'Share Results',
    'Price Chart': 'Price Chart',
    'Candlestick': 'Candlestick',
    'Line': 'Line',
    'Total Return': 'Total Return',
    'Win Rate': 'Win Rate',
    'Performance Metrics': 'Performance Metrics',
    'Profit Factor': 'Profit Factor',
    'Sharpe Ratio': 'Sharpe Ratio',
    'Crypto Trading Glossary for Beginners': '초보자를 위한 암호화폐 거래 용어집',
    'Learn crypto terms with traditional finance comparisons': '전통적인 금융과 비교하여 암호화폐 용어를 배워보세요',
    'Search crypto or traditional terms...': '암호화폐 또는 전통적인 용어를 검색하세요...',
    'Side-by-Side Comparison': '나란히 비교',
    'Accordion View': '아코디언 보기',
    'Examples:': '예시:',
    'Example:': '예시:',
    'Learning Progress': '학습 진행률',
    'Beginner Terms': '초급 용어',
    'Intermediate Terms': '중급 용어',
    'Advanced Terms': '고급 용어',
    'Total Showing': '총 표시',
    'Research Corpus Manager': '연구 코퍼스 관리자',
    'Organize your research materials, PDFs, URLs, and notes to build a comprehensive knowledge base for your trading strategies.': '거래 전략을 위한 포괄적인 지식 기반을 구축하기 위해 연구 자료, PDF, URL 및 메모를 정리하세요.',
    'Uploading...': '업로드 중...',
    'Upload PDF': 'PDF 업로드',
    'Upload Image': '이미지 업로드',
    'Add URL': 'URL 추가',
    'Add Note': '메모 추가',
    'Search research items...': '연구 항목 검색...',
    'Filter by Tags': '태그별 필터',
    'All Items': '모든 항목',
    'PDFs': 'PDF 파일',
    'URLs': 'URL 링크',
    'Notes': '메모',
    'Images': '이미지',
    'No research items found. Start by uploading some PDFs or adding URLs!': '연구 항목을 찾을 수 없습니다. PDF를 업로드하거나 URL을 추가하여 시작하세요!',
    'Added': '추가됨',
    'Edit': '편집',
    'View': '보기',
    'Open Link': '링크 열기',
    'Delete': '삭제',
    'Edit Item': '항목 편집',
    'Title': '제목',
    'URL': 'URL',
    'Content': '내용',
    'Summary': '요약',
    'Tags': '태그',
    'Add Item': '항목 추가',
    'Portfolio Dashboard': '포트폴리오 대시보드',
    'Track your crypto holdings and performance': '포트폴리오 보유 현황 및 성과 확인',
    'Total Portfolio Value': '포트폴리오 총 가치',
    '24h Change': '24시간 변동',
    'Total P&L': '총 손익',
    'Assets': '자산',
    'Holdings': '보유',
    'Your Holdings': '보유 자산',
    'Asset': '자산',
    'Amount': '금액',
    'Value': '가치',
    'Allocation': '배분',
    'Actions': '조치',
    'View Details': '상세 보기',
    'Trade': '거래',
    'Refresh': '새로고침',
    'All time': '전체 기간',
    'Strategy Overview': 'Strategy Overview',
    'Key Metrics': 'Key Metrics',
    'Implementation': 'Implementation',
    'Important Considerations': 'Important Considerations',
    'Generated Backtest Code': 'Generated Backtest Code',
    'Copy Strategy': 'Copy Strategy',
    'Generate Backtest Code': 'Generate Backtest Code',
    'View Analysis': 'View Analysis',
    'Quick Strategy Ideas': 'Quick Strategy Ideas',
    'Chat': 'Chat',
    'Analysis': 'Analysis',
    'Close': 'Close',
    'Download': 'Download',
    'Risk': 'Risk',
    'Low': 'Low',
    'Medium': 'Medium',
    'High': 'High',
    'Expected Return': 'Expected Return',
    'Cooking up your strategy': 'Cooking up your strategy',
  },
  ja: {
    'Welcome to Bibim 🥘': 'Bibimへようこそ 🥘',
    'Your friendly AI-powered crypto trading companion. Mix your perfect strategy like bibimbap... more like cryptobap (크립토밥)!': 'フレンドリーなAI搭載の暗号通貨取引コンパニオンです。ビビンバのように完璧な戦略をミックスしましょう...クリプトバップのように！',
    'Start Mixing Your Strategy': '戦略のミキシングを開始',
    "Chef Trader's Prep Station": 'シェフトレーダーの準備ステーション',
    'Why Choose Bibim?': 'なぜBibimを選ぶのか？',
    'AI-Powered Strategy Chef': 'AI搭載ストラテジーシェフ',
    'Our AI chef helps you create and optimize your trading strategies with precision.': '私たちのAIシェフが、精密に取引戦略を作成し最適化するお手伝いをします。',
    'Market Data Kitchen': 'マーケットデータキッチン',
    'Access real-time market data and analytics to make informed decisions.': 'リアルタイムの市場データと分析にアクセスして、情報に基づいた決定を行いましょう。',
    'Sentiment Analysis Spice': 'センチメント分析スパイス',
    'Add market sentiment analysis to your strategy for that extra flavor.': '戦略に市場センチメント分析を追加して、特別な風味を加えましょう。',
    'Created by: philxdaegu ': '作成者: philxdaegu ',
    'Dashboard': 'ダッシュボード',
    'Strategy Builder': 'ストラテジービルダー',
    'Backtest': 'バックテスト',
    'Crypto Guide': '暗号通貨ガイド',
    'Strategy Builder 🥘': 'ストラテジービルダー 🥘',
    'Strategy Chef': 'ストラテジーシェフ',
    'Loading...': '読み込み中...',
    'Error': 'エラー',
    'Refresh': '更新',
    'Save': '保存',
    'Cancel': 'キャンセル',
    'Submit': '送信',
    'R&D-Agent-Quant Framework': 'R&D-Agent-Quant Framework',
    'Autonomous Research, Development, and Quantitative Trading Platform': 'Autonomous Research, Development, and Quantitative Trading Platform',
    'Research Progress': 'Research Progress',
    'Development Status': 'Development Status',
    'Agent Activity': 'Agent Activity',
    'Quant Performance': 'Quant Performance',
    'Research': 'Research',
    'Development': 'Development',
    'Agent Framework': 'Agent Framework',
    'Quant Strategies': 'Quant Strategies',
    'Research Corpus': 'Research Corpus',
    'Strategy Backtest': 'Strategy Backtest',
    'Backtest Configuration': 'Backtest Configuration',
    'Timeframe': 'Timeframe',
    '1 Minute': '1 Minute',
    '5 Minutes': '5 Minutes',
    '15 Minutes': '15 Minutes',
    '1 Hour': '1 Hour',
    '4 Hours': '4 Hours',
    '1 Day': '1 Day',
    'Start Date': 'Start Date',
    'End Date': 'End Date',
    'Running...': 'Running...',
    'Run Backtest': 'Run Backtest',
    'Backtest Results': 'Backtest Results',
    'Save Results': 'Save Results',
    'Share Results': 'Share Results',
    'Price Chart': 'Price Chart',
    'Candlestick': 'Candlestick',
    'Line': 'Line',
    'Total Return': 'Total Return',
    'Win Rate': 'Win Rate',
    'Performance Metrics': 'Performance Metrics',
    'Profit Factor': 'Profit Factor',
    'Sharpe Ratio': 'Sharpe Ratio',
    'Crypto Trading Glossary for Beginners': 'Crypto Trading Glossary for Beginners',
    'Learn crypto terms with traditional finance comparisons': 'Learn crypto terms with traditional finance comparisons',
    'Search crypto or traditional terms...': 'Search crypto or traditional terms...',
    'Side-by-Side Comparison': 'Side-by-Side Comparison',
    'Accordion View': 'Accordion View',
    'Examples:': 'Examples:',
    'Example:': 'Example:',
    'Learning Progress': 'Learning Progress',
    'Beginner Terms': 'Beginner Terms',
    'Intermediate Terms': 'Intermediate Terms',
    'Advanced Terms': 'Advanced Terms',
    'Total Showing': 'Total Showing',
    'Research Corpus Manager': 'Research Corpus Manager',
    'Organize your research materials, PDFs, URLs, and notes to build a comprehensive knowledge base for your trading strategies.': 'Organize your research materials, PDFs, URLs, and notes to build a comprehensive knowledge base for your trading strategies.',
    'Uploading...': 'Uploading...',
    'Upload PDF': 'Upload PDF',
    'Upload Image': 'Upload Image',
    'Add URL': 'Add URL',
    'Add Note': 'Add Note',
    'Search research items...': 'Search research items...',
    'Filter by Tags': 'Filter by Tags',
    'All Items': 'All Items',
    'PDFs': 'PDFs',
    'URLs': 'URLs',
    'Notes': 'Notes',
    'Images': 'Images',
    'No research items found. Start by uploading some PDFs or adding URLs!': 'No research items found. Start by uploading some PDFs or adding URLs!',
    'Added': 'Added',
    'Edit': 'Edit',
    'View': 'View',
    'Open Link': 'Open Link',
    'Delete': 'Delete',
    'Edit Item': 'Edit Item',
    'Title': 'Title',
    'URL': 'URL',
    'Content': 'Content',
    'Summary': 'Summary',
    'Tags': 'Tags',
    'Add Item': 'Add Item',
  },
  zh: {
    'Welcome to Bibim 🥘': '欢迎来到Bibim 🥘',
    'Your friendly AI-powered crypto trading companion. Mix your perfect strategy like bibimbap... more like cryptobap (크립토밥)!': '您友好的AI驱动加密货币交易伙伴。像拌饭一样混合您的完美策略...更像加密饭！',
    'Start Mixing Your Strategy': '开始混合您的策略',
    "Chef Trader's Prep Station": '主厨交易员的准备站',
    'Why Choose Bibim?': '为什么选择Bibim？',
    'AI-Powered Strategy Chef': 'AI驱动的策略主厨',
    'Our AI chef helps you create and optimize your trading strategies with precision.': '我们的AI主厨帮助您精确地创建和优化交易策略。',
    'Market Data Kitchen': '市场数据厨房',
    'Access real-time market data and analytics to make informed decisions.': '访问实时市场数据和分析，做出明智的决策。',
    'Sentiment Analysis Spice': '情绪分析调料',
    'Add market sentiment analysis to your strategy for that extra flavor.': '为您的策略添加市场情绪分析，增加额外的风味。',
    'Created by: philxdaegu ': '创建者: philxdaegu ',
    'Dashboard': '仪表板',
    'Strategy Builder': '策略构建器',
    'Backtest': '回测',
    'Crypto Guide': '加密货币指南',
    'Strategy Builder 🥘': '策略构建器 🥘',
    'Strategy Chef': '策略厨师',
    'Loading...': '加载中...',
    'Error': '错误',
    'Refresh': '刷新',
    'Save': '保存',
    'Cancel': '取消',
    'Submit': '提交',
    'R&D-Agent-Quant Framework': 'R&D-Agent-Quant Framework',
    'Autonomous Research, Development, and Quantitative Trading Platform': 'Autonomous Research, Development, and Quantitative Trading Platform',
    'Research Progress': 'Research Progress',
    'Development Status': 'Development Status',
    'Agent Activity': 'Agent Activity',
    'Quant Performance': 'Quant Performance',
    'Research': 'Research',
    'Development': 'Development',
    'Agent Framework': 'Agent Framework',
    'Quant Strategies': 'Quant Strategies',
    'Research Corpus': 'Research Corpus',
    'Strategy Backtest': 'Strategy Backtest',
    'Backtest Configuration': 'Backtest Configuration',
    'Timeframe': 'Timeframe',
    '1 Minute': '1 Minute',
    '5 Minutes': '5 Minutes',
    '15 Minutes': '15 Minutes',
    '1 Hour': '1 Hour',
    '4 Hours': '4 Hours',
    '1 Day': '1 Day',
    'Start Date': 'Start Date',
    'End Date': 'End Date',
    'Running...': 'Running...',
    'Run Backtest': 'Run Backtest',
    'Backtest Results': 'Backtest Results',
    'Save Results': 'Save Results',
    'Share Results': 'Share Results',
    'Price Chart': 'Price Chart',
    'Candlestick': 'Candlestick',
    'Line': 'Line',
    'Total Return': 'Total Return',
    'Win Rate': 'Win Rate',
    'Performance Metrics': 'Performance Metrics',
    'Profit Factor': 'Profit Factor',
    'Sharpe Ratio': 'Sharpe Ratio',
    'Crypto Trading Glossary for Beginners': 'Crypto Trading Glossary for Beginners',
    'Learn crypto terms with traditional finance comparisons': 'Learn crypto terms with traditional finance comparisons',
    'Search crypto or traditional terms...': 'Search crypto or traditional terms...',
    'Side-by-Side Comparison': 'Side-by-Side Comparison',
    'Accordion View': 'Accordion View',
    'Examples:': 'Examples:',
    'Example:': 'Example:',
    'Learning Progress': 'Learning Progress',
    'Beginner Terms': 'Beginner Terms',
    'Intermediate Terms': 'Intermediate Terms',
    'Advanced Terms': 'Advanced Terms',
    'Total Showing': 'Total Showing',
    'Research Corpus Manager': 'Research Corpus Manager',
    'Organize your research materials, PDFs, URLs, and notes to build a comprehensive knowledge base for your trading strategies.': 'Organize your research materials, PDFs, URLs, and notes to build a comprehensive knowledge base for your trading strategies.',
    'Uploading...': 'Uploading...',
    'Upload PDF': 'Upload PDF',
    'Upload Image': 'Upload Image',
    'Add URL': 'Add URL',
    'Add Note': 'Add Note',
    'Search research items...': 'Search research items...',
    'Filter by Tags': 'Filter by Tags',
    'All Items': 'All Items',
    'PDFs': 'PDFs',
    'URLs': 'URLs',
    'Notes': 'Notes',
    'Images': 'Images',
    'No research items found. Start by uploading some PDFs or adding URLs!': 'No research items found. Start by uploading some PDFs or adding URLs!',
    'Added': 'Added',
    'Edit': 'Edit',
    'View': 'View',
    'Open Link': 'Open Link',
    'Delete': 'Delete',
    'Edit Item': 'Edit Item',
    'Title': 'Title',
    'URL': 'URL',
    'Content': 'Content',
    'Summary': 'Summary',
    'Tags': 'Tags',
    'Add Item': 'Add Item',
  },
  es: {
    'Welcome to Bibim 🥘': 'Bienvenido a Bibim 🥘',
    'Your friendly AI-powered crypto trading companion. Mix your perfect strategy like bibimbap... more like cryptobap (크립토밥)!': 'Tu compañero amigable de trading de criptomonedas impulsado por IA. Mélangez tu estrategia perfecta como bibimbap... ¡más como cryptobap!',
    'Start Mixing Your Strategy': 'Comienza a Mezclar Tu Estrategia',
    "Chef Trader's Prep Station": 'Estación de Preparación del Chef Trader',
    'Why Choose Bibim?': '¿Por qué elegir Bibim?',
    'AI-Powered Strategy Chef': 'Chef de Estrategias Impulsado por IA',
    'Our AI chef helps you create and optimize your trading strategies with precision.': 'Nuestro chef de IA te ayuda a crear y optimizar tus estrategias de trading con precisión.',
    'Market Data Kitchen': 'Cocina de Datos de Mercado',
    'Access real-time market data and analytics to make informed decisions.': 'Accede a datos de mercado en tiempo real y análisis para tomar decisiones informadas.',
    'Sentiment Analysis Spice': 'Especia de Análisis de Sentimiento',
    'Add market sentiment analysis to your strategy for that extra flavor.': 'Añade análisis de sentimiento del mercado a tu estrategia para ese sabor extra.',
    'Created by: philxdaegu ': 'Creado por: philxdaegu ',
    'Dashboard': 'Panel de Control',
    'Strategy Builder': 'Constructor de Estrategias',
    'Backtest': 'Prueba Retrospectiva',
    'Crypto Guide': 'Guía Crypto',
    'Strategy Builder 🥘': 'Constructor de Estrategias 🥘',
    'Strategy Chef': 'Chef de Estrategias',
    'Loading...': 'Cargando...',
    'Error': 'Error',
    'Refresh': 'Actualizar',
    'Save': 'Guardar',
    'Cancel': 'Cancelar',
    'Submit': 'Enviar',
    'R&D-Agent-Quant Framework': 'R&D-Agent-Quant Framework',
    'Autonomous Research, Development, and Quantitative Trading Platform': 'Autonomous Research, Development, and Quantitative Trading Platform',
    'Research Progress': 'Research Progress',
    'Development Status': 'Development Status',
    'Agent Activity': 'Agent Activity',
    'Quant Performance': 'Quant Performance',
    'Research': 'Research',
    'Development': 'Development',
    'Agent Framework': 'Agent Framework',
    'Quant Strategies': 'Quant Strategies',
    'Research Corpus': 'Research Corpus',
    'Strategy Backtest': 'Strategy Backtest',
    'Backtest Configuration': 'Backtest Configuration',
    'Timeframe': 'Timeframe',
    '1 Minute': '1 Minute',
    '5 Minutes': '5 Minutes',
    '15 Minutes': '15 Minutes',
    '1 Hour': '1 Hour',
    '4 Hours': '4 Hours',
    '1 Day': '1 Day',
    'Start Date': 'Start Date',
    'End Date': 'End Date',
    'Running...': 'Running...',
    'Run Backtest': 'Run Backtest',
    'Backtest Results': 'Backtest Results',
    'Save Results': 'Save Results',
    'Share Results': 'Share Results',
    'Price Chart': 'Price Chart',
    'Candlestick': 'Candlestick',
    'Line': 'Line',
    'Total Return': 'Total Return',
    'Win Rate': 'Win Rate',
    'Performance Metrics': 'Performance Metrics',
    'Profit Factor': 'Profit Factor',
    'Sharpe Ratio': 'Sharpe Ratio',
    'Crypto Trading Glossary for Beginners': 'Crypto Trading Glossary for Beginners',
    'Learn crypto terms with traditional finance comparisons': 'Learn crypto terms with traditional finance comparisons',
    'Search crypto or traditional terms...': 'Search crypto or traditional terms...',
    'Side-by-Side Comparison': 'Side-by-Side Comparison',
    'Accordion View': 'Accordion View',
    'Examples:': 'Examples:',
    'Example:': 'Example:',
    'Learning Progress': 'Learning Progress',
    'Beginner Terms': 'Beginner Terms',
    'Intermediate Terms': 'Intermediate Terms',
    'Advanced Terms': 'Advanced Terms',
    'Total Showing': 'Total Showing',
    'Research Corpus Manager': 'Research Corpus Manager',
    'Organize your research materials, PDFs, URLs, and notes to build a comprehensive knowledge base for your trading strategies.': 'Organize your research materials, PDFs, URLs, and notes to build a comprehensive knowledge base for your trading strategies.',
    'Uploading...': 'Uploading...',
    'Upload PDF': 'Upload PDF',
    'Upload Image': 'Upload Image',
    'Add URL': 'Add URL',
    'Add Note': 'Add Note',
    'Search research items...': 'Search research items...',
    'Filter by Tags': 'Filter by Tags',
    'All Items': 'All Items',
    'PDFs': 'PDFs',
    'URLs': 'URLs',
    'Notes': 'Notes',
    'Images': 'Images',
    'No research items found. Start by uploading some PDFs or adding URLs!': 'No research items found. Start by uploading some PDFs or adding URLs!',
    'Added': 'Added',
    'Edit': 'Edit',
    'View': 'View',
    'Open Link': 'Open Link',
    'Delete': 'Delete',
    'Edit Item': 'Edit Item',
    'Title': 'Title',
    'URL': 'URL',
    'Content': 'Content',
    'Summary': 'Summary',
    'Tags': 'Tags',
    'Add Item': 'Add Item',
  },
  fr: {
    'Welcome to Bibim 🥘': 'Bienvenue chez Bibim 🥘',
    'Your friendly AI-powered crypto trading companion. Mix your perfect strategy like bibimbap... more like cryptobap (크립토밥)!': 'Votre compagnon de trading crypto alimenté par IA. Mélangez votre stratégie parfaite comme le bibimbap... plutôt comme le cryptobap !',
    'Start Mixing Your Strategy': 'Commencez à Mélanger Votre Stratégie',
    "Chef Trader's Prep Station": 'Station de Préparation du Chef Trader',
    'Why Choose Bibim?': 'Pourquoi choisir Bibim ?',
    'AI-Powered Strategy Chef': 'Chef de Stratégie Alimenté par IA',
    'Our AI chef helps you create and optimize your trading strategies with precision.': 'Notre chef IA vous aide à créer et optimiser vos stratégies de trading avec précision.',
    'Market Data Kitchen': 'Cuisine des Données de Marché',
    'Access real-time market data and analytics to make informed decisions.': 'Accédez aux données de marché en temps réel et aux analyses pour prendre des décisions éclairées.',
    'Sentiment Analysis Spice': 'Épice d\'Analyse de Sentiment',
    'Add market sentiment analysis to your strategy for that extra flavor.': 'Ajoutez l\'analyse de sentiment du marché à votre stratégie pour cette saveur supplémentaire.',
    'Created by: philxdaegu ': 'Créé par: philxdaegu ',
    'Dashboard': 'Tableau de Bord',
    'Strategy Builder': 'Constructeur de Stratégie',
    'Backtest': 'Test Rétrospectif',
    'Crypto Guide': 'Guide Crypto',
    'Strategy Builder 🥘': 'Constructeur de Stratégie 🥘',
    'Strategy Chef': 'Chef de Stratégie',
    'Loading...': 'Chargement...',
    'Error': 'Erreur',
    'Refresh': 'Actualiser',
    'Save': 'Sauvegarder',
    'Cancel': 'Annuler',
    'Submit': 'Soumettre',
    'R&D-Agent-Quant Framework': 'R&D-Agent-Quant Framework',
    'Autonomous Research, Development, and Quantitative Trading Platform': 'Autonomous Research, Development, and Quantitative Trading Platform',
    'Research Progress': 'Research Progress',
    'Development Status': 'Development Status',
    'Agent Activity': 'Agent Activity',
    'Quant Performance': 'Quant Performance',
    'Research': 'Research',
    'Development': 'Development',
    'Agent Framework': 'Agent Framework',
    'Quant Strategies': 'Quant Strategies',
    'Research Corpus': 'Research Corpus',
    'Strategy Backtest': 'Strategy Backtest',
    'Backtest Configuration': 'Backtest Configuration',
    'Timeframe': 'Timeframe',
    '1 Minute': '1 Minute',
    '5 Minutes': '5 Minutes',
    '15 Minutes': '15 Minutes',
    '1 Hour': '1 Hour',
    '4 Hours': '4 Hours',
    '1 Day': '1 Day',
    'Start Date': 'Start Date',
    'End Date': 'End Date',
    'Running...': 'Running...',
    'Run Backtest': 'Run Backtest',
    'Backtest Results': 'Backtest Results',
    'Save Results': 'Save Results',
    'Share Results': 'Share Results',
    'Price Chart': 'Price Chart',
    'Candlestick': 'Candlestick',
    'Line': 'Line',
    'Total Return': 'Total Return',
    'Win Rate': 'Win Rate',
    'Performance Metrics': 'Performance Metrics',
    'Profit Factor': 'Profit Factor',
    'Sharpe Ratio': 'Sharpe Ratio',
    'Crypto Trading Glossary for Beginners': 'Crypto Trading Glossary for Beginners',
    'Learn crypto terms with traditional finance comparisons': 'Learn crypto terms with traditional finance comparisons',
    'Search crypto or traditional terms...': 'Search crypto or traditional terms...',
    'Side-by-Side Comparison': 'Side-by-Side Comparison',
    'Accordion View': 'Accordion View',
    'Examples:': 'Examples:',
    'Example:': 'Example:',
    'Learning Progress': 'Learning Progress',
    'Beginner Terms': 'Beginner Terms',
    'Intermediate Terms': 'Intermediate Terms',
    'Advanced Terms': 'Advanced Terms',
    'Total Showing': 'Total Showing',
    'Research Corpus Manager': 'Research Corpus Manager',
    'Organize your research materials, PDFs, URLs, and notes to build a comprehensive knowledge base for your trading strategies.': 'Organize your research materials, PDFs, URLs, and notes to build a comprehensive knowledge base for your trading strategies.',
    'Uploading...': 'Uploading...',
    'Upload PDF': 'Upload PDF',
    'Upload Image': 'Upload Image',
    'Add URL': 'Add URL',
    'Add Note': 'Add Note',
    'Search research items...': 'Search research items...',
    'Filter by Tags': 'Filter by Tags',
    'All Items': 'All Items',
    'PDFs': 'PDFs',
    'URLs': 'URLs',
    'Notes': 'Notes',
    'Images': 'Images',
    'No research items found. Start by uploading some PDFs or adding URLs!': 'No research items found. Start by uploading some PDFs or adding URLs!',
    'Added': 'Added',
    'Edit': 'Edit',
    'View': 'View',
    'Open Link': 'Open Link',
    'Delete': 'Delete',
    'Edit Item': 'Edit Item',
    'Title': 'Title',
    'URL': 'URL',
    'Content': 'Content',
    'Summary': 'Summary',
    'Tags': 'Tags',
    'Add Item': 'Add Item',
  },
  de: {
    'Welcome to Bibim 🥘': 'Willkommen bei Bibim 🥘',
    'Your friendly AI-powered crypto trading companion. Mix your perfect strategy like bibimbap... more like cryptobap (크립토밥)!': 'Ihr freundlicher KI-gestützter Krypto-Trading-Begleiter. Mischen Sie Ihre perfekte Strategie wie Bibimbap... eher wie Cryptobap!',
    'Start Mixing Your Strategy': 'Beginnen Sie mit dem Mischen Ihrer Strategie',
    "Chef Trader's Prep Station": 'Vorbereitungsstation des Chef-Traders',
    'Why Choose Bibim?': 'Warum Bibim wählen?',
    'AI-Powered Strategy Chef': 'KI-gestützter Strategie-Koch',
    'Our AI chef helps you create and optimize your trading strategies with precision.': 'Unser KI-Koch hilft Ihnen dabei, Ihre Trading-Strategien präzise zu erstellen und zu optimieren.',
    'Market Data Kitchen': 'Marktdaten-Küche',
    'Access real-time market data and analytics to make informed decisions.': 'Greifen Sie auf Echtzeit-Marktdaten und Analysen zu, um fundierte Entscheidungen zu treffen.',
    'Sentiment Analysis Spice': 'Sentiment-Analyse-Gewürz',
    'Add market sentiment analysis to your strategy for that extra flavor.': 'Fügen Sie Marktsentiment-Analyse zu Ihrer Strategie hinzu für den extra Geschmack.',
    'Created by: philxdaegu ': 'Erstellt von: philxdaegu ',
    'Dashboard': 'Dashboard',
    'Strategy Builder': 'Strategie-Builder',
    'Backtest': 'Backtest',
    'Crypto Guide': 'Krypto-Leitfaden',
    'Strategy Builder 🥘': 'Strategie-Builder 🥘',
    'Strategy Chef': 'Strategie-Koch',
    'Loading...': 'Laden...',
    'Error': 'Fehler',
    'Refresh': 'Aktualisieren',
    'Save': 'Speichern',
    'Cancel': 'Abbrechen',
    'Submit': 'Senden',
    'R&D-Agent-Quant Framework': 'R&D-Agent-Quant Framework',
    'Autonomous Research, Development, and Quantitative Trading Platform': 'Autonomous Research, Development, and Quantitative Trading Platform',
    'Research Progress': 'Research Progress',
    'Development Status': 'Development Status',
    'Agent Activity': 'Agent Activity',
    'Quant Performance': 'Quant Performance',
    'Research': 'Research',
    'Development': 'Development',
    'Agent Framework': 'Agent Framework',
    'Quant Strategies': 'Quant Strategies',
    'Research Corpus': 'Research Corpus',
    'Strategy Backtest': 'Strategy Backtest',
    'Backtest Configuration': 'Backtest Configuration',
    'Timeframe': 'Timeframe',
    '1 Minute': '1 Minute',
    '5 Minutes': '5 Minutes',
    '15 Minutes': '15 Minutes',
    '1 Hour': '1 Hour',
    '4 Hours': '4 Hours',
    '1 Day': '1 Day',
    'Start Date': 'Start Date',
    'End Date': 'End Date',
    'Running...': 'Running...',
    'Run Backtest': 'Run Backtest',
    'Backtest Results': 'Backtest Results',
    'Save Results': 'Save Results',
    'Share Results': 'Share Results',
    'Price Chart': 'Price Chart',
    'Candlestick': 'Candlestick',
    'Line': 'Line',
    'Total Return': 'Total Return',
    'Win Rate': 'Win Rate',
    'Performance Metrics': 'Performance Metrics',
    'Profit Factor': 'Profit Factor',
    'Sharpe Ratio': 'Sharpe Ratio',
    'Crypto Trading Glossary for Beginners': 'Crypto Trading Glossary for Beginners',
    'Learn crypto terms with traditional finance comparisons': 'Learn crypto terms with traditional finance comparisons',
    'Search crypto or traditional terms...': 'Search crypto or traditional terms...',
    'Side-by-Side Comparison': 'Side-by-Side Comparison',
    'Accordion View': 'Accordion View',
    'Examples:': 'Examples:',
    'Example:': 'Example:',
    'Learning Progress': 'Learning Progress',
    'Beginner Terms': 'Beginner Terms',
    'Intermediate Terms': 'Intermediate Terms',
    'Advanced Terms': 'Advanced Terms',
    'Total Showing': 'Total Showing',
    'Research Corpus Manager': 'Research Corpus Manager',
    'Organize your research materials, PDFs, URLs, and notes to build a comprehensive knowledge base for your trading strategies.': 'Organize your research materials, PDFs, URLs, and notes to build a comprehensive knowledge base for your trading strategies.',
    'Uploading...': 'Uploading...',
    'Upload PDF': 'Upload PDF',
    'Upload Image': 'Upload Image',
    'Add URL': 'Add URL',
    'Add Note': 'Add Note',
    'Search research items...': 'Search research items...',
    'Filter by Tags': 'Filter by Tags',
    'All Items': 'All Items',
    'PDFs': 'PDFs',
    'URLs': 'URLs',
    'Notes': 'Notes',
    'Images': 'Images',
    'No research items found. Start by uploading some PDFs or adding URLs!': 'No research items found. Start by uploading some PDFs or adding URLs!',
    'Added': 'Added',
    'Edit': 'Edit',
    'View': 'View',
    'Open Link': 'Open Link',
    'Delete': 'Delete',
    'Edit Item': 'Edit Item',
    'Title': 'Title',
    'URL': 'URL',
    'Content': 'Content',
    'Summary': 'Summary',
    'Tags': 'Tags',
    'Add Item': 'Add Item',
  },
};

interface TranslationProviderProps {
  children: ReactNode;
}

export const TranslationProvider: React.FC<TranslationProviderProps> = ({ children }) => {
  const [currentLanguage, setCurrentLanguage] = useState<Language>('en');
  const [isTranslating, setIsTranslating] = useState(false);
  const [translationCache, setTranslationCache] = useState(new Map<string, string>());

  // Load saved language preference
  useEffect(() => {
    const savedLanguage = localStorage.getItem('preferred-language') as Language;
    if (savedLanguage && ['en', 'ko', 'ja', 'zh', 'es', 'fr', 'de'].includes(savedLanguage)) {
      setCurrentLanguage(savedLanguage);
    }
  }, []);

  const setLanguage = (lang: Language) => {
    setCurrentLanguage(lang);
    localStorage.setItem('preferred-language', lang);
  };

  const translateSync = (text: string, targetLang?: Language): string => {
    const lang = targetLang || currentLanguage;
    
    // Return original text if it's English and target is English
    if (lang === 'en') {
      return text;
    }

    // Check static translations first
    if (staticTranslations[lang] && staticTranslations[lang][text]) {
      return staticTranslations[lang][text];
    }

    // Check cache
    const cacheKey = `${lang}-${text}`;
    if (translationCache.has(cacheKey)) {
      return translationCache.get(cacheKey)!;
    }

    // Return original text if no translation available
    return text;
  };

  const translate = async (text: string, targetLang?: Language): Promise<string> => {
    const lang = targetLang || currentLanguage;
    
    // Return original text if it's English and target is English
    if (lang === 'en') {
      return text;
    }

    // Check static translations first
    if (staticTranslations[lang] && staticTranslations[lang][text]) {
      return staticTranslations[lang][text];
    }

    // Check cache
    const cacheKey = `${lang}-${text}`;
    if (translationCache.has(cacheKey)) {
      return translationCache.get(cacheKey)!;
    }

    try {
      setIsTranslating(true);
      
      // Use translation service
      const translatedText = await translationService.translate(text, lang, 'en');
      
      // Cache the result
      setTranslationCache(prev => new Map(prev.set(cacheKey, translatedText)));
      
      return translatedText;
    } catch (error) {
      console.error('Translation failed:', error);
      return text; // Return original text on error
    } finally {
      setIsTranslating(false);
    }
  };

  const clearCache = () => {
    setTranslationCache(new Map());
    translationService.clearCache();
  };

  const value: TranslationContextType = {
    currentLanguage,
    setLanguage,
    translate,
    translateSync,
    isTranslating,
    translationCache,
    clearCache,
  };

  return (
    <TranslationContext.Provider value={value}>
      {children}
    </TranslationContext.Provider>
  );
};

export const useTranslation = () => {
  const context = useContext(TranslationContext);
  if (context === undefined) {
    throw new Error('useTranslation must be used within a TranslationProvider');
  }
  return context;
};

// Hook for easy translation with loading state
export const useTranslate = () => {
  const { translate, translateSync, currentLanguage, isTranslating } = useTranslation();
  
  return {
    t: translateSync, // Synchronous translation (uses cache/static)
    tAsync: translate, // Asynchronous translation (uses API)
    currentLanguage,
    isTranslating,
  };
};

// Create a TranslatedText component (already added to CryptoGlossary)
const TranslatedText: React.FC<{ text: string; variant?: any; [key: string]: any }> = ({ 
  text, 
  variant = "body1", 
  ...props 
}) => {
  const { translateSync, currentLanguage } = useTranslation();
  
  if (currentLanguage === 'en') {
    return <Typography variant={variant} {...props}>{text}</Typography>;
  }
  
  return <Typography variant={variant} {...props}>{translateSync(text)}</Typography>;
};

export default TranslationContext; 